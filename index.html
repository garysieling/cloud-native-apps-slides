<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Cloud-Native JavaScript Apps</title>

		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<!--
	audience profile
		junior UI dev
		mid level UI dev
		senior / architect level dev

	what do i have to offer
		experience of working on three serverless applications
			Cumulus
			secret #1
			unnamed secret #2
		devops perspective
			security throughout
			a story about security? - a breach (target? )

	story
		A chronology, using a timeline for events, 
		offers an easy organization pattern for a narrative speech.

		the princess bride
			grandfather telling his grandson a story
			narrative framing - plot device
			from the perspective of another character
				someone who is concerned about security talking to a younger developer

		A short quotation, anecdote, appropriate humor or fact about
		the topic of your narrative work well as an introduction.

		Combine that summary with a wrap-up quote, fact or anecdote 
		that reminds your audience of your main topic. A restatement 
		of the moral or lesson works well for a narrative speech with 
		this message.

		todo - pictures of the forest fire in the artic thing
		todo - talk about the value of lambdas
			- faster startup time
			- can I get a visual of spiky load
			- make sure javascript is mentioned a lot
				- leaflet example

		read up on snowflake plot structure


		retrospective on a talking


		endgame - objective - tactic
		(primary message / conflict) - (3 objectives) - ()

		(cognizant of data breaches) - (what do you need to know to achieve / understand the endgame) - (specific anecdotes / stats / facts)
		
		editing: how does every word / detail related to one of the above items
			(i need to know this, because of this objective, for this endgame)

		(endgame: devops is good for your career)

		(endgame: we need to build ever more robust systems)
			(objective: developers need to provide better stability)
				(tactic: microservices)
				(tactic: code isolation)
				(tactic: automated testing)
			(objective: developers need to provide better security)
				(tactic: least privilege)
				(tactic: containerization - limiting blast radius)
			(objective: developers need to build software to fit a client's financial needs)
				(tactic: lambda)
				(tactic: autoscaling / ECS)
				(tactic: unbundled pricing)

				-->
				<section>
					<h2>Cloud-Native JavaScript Apps</h2>

					<aside class="notes">
						* Hi, I'm Gary Sieling

						* Today I'm going to talk about cloud native applications
					</aside>
				</section>

				<section>
					<p><img src="images/e84a.png" /></p>
					<p><img src="images/e84b.png" /></p>

					<aside class="notes">
						* I work for Element 84 which is a software consultancy based in Alexandria, VA.

						* We do custom software on AWS. Some of our clients are government agencies, notably 
						including NASA.

						* Internally we have a lot of experience building geospatial applications, which 
						is the inspiration for this talk.
					</aside>
				</section>

				<section>
					<h1>Projects</h1>
					<ul>
						<li>Cumulus</li>
						<li>Pangeo</li>
					</ul>
					
					<aside class="notes">
						* Cumulus is an open source project by NASA to ingest collections of satellite imagery into the cloud. 

						* Pangeo is a community platform for Big Data geoscience, that uses the cloud to scale processing.
					</aside>
				</section>
	
				<section>
					<img src="images/myspace.png" />
					
					<aside class="notes">
						* Original site was unstable

						* You could customize the theming of the site extensively

						* There were phishing schemes to get your username / password 
					</aside>
				</section>

				<section>
					<img src="images/iphone11.jpeg" />
					
					<aside class="notes">
						* Execs say - "Why isn't this product as easy to use as the iPhone"
					</aside>
				</section>

				<section>
					<img src="images/breaches.jpeg">
					
					<aside class="notes">
							* We still have a long way to go with cloud software

							* This affects everyone

							* There is a lot of backpressure on consulting projects to do better
					</aside>
				</section>

				<section>
					<h1>Cost</h1>
					<blockquote>
						DevOps specialists and site reliability engineers are among the highest paid, most experienced developers most satisfied with their jobs, and are looking for new jobs at the lowest levels.
					</blockquote>
					
					<aside class="notes">
							* We have to build software that in a way that is financially viable, or we won't have jobs
					</aside>
				</section>

				<section>
					<h2>
						Robust Serverless software
					</h2>
					<ul>
						<li>Stable</li>
						<li>Secure</li>
						<li>Affordable</li>
					</ul>
					
					<aside class="notes">
							* Three objectives - these will keep our customers happy, and reduce the amount we get paged.

							* Affordability is a novel point for software
					</aside>
				</section>

				<section>
					<h1>Case study: satellite imagery data pipeline</h1>
					
					<aside class="notes">
							* This case study is based on experience with several serverless javascript applications on AWS.
					</aside>
				</section>
	
				<section>
					<img src="images/landsat-illustration.jpg" />
					
					<aside class="notes">
							* This is an artists rendition of one of the NASA landsat satellites.

							* These are about the size of a bus, and have sensors that retrieve imagery in 
						different color bands, in both the visible and non-visible spectrum.

						* The data from these is used for many scientific purposes.
					</aside>
				</section>
	
				<section>
					<h1>DigitalGlobe</h1>
					<ul>
						<li>80 TB/day</li>
						<li>100 PB Stored</li>
						<!--li>40% cache hit rate</li-->
					</ul>
					
					<aside class="notes">
							* I watched a talk by DigitalGlobe from an AWS conference.

							* This a lot of data to store and archive.
					</aside>
				</section>
				
				<section>
					<img src="images/aws-diagram.png " />
					
					<aside class="notes">
							* The basic data pipeline for imagery is pretty straightforward and parallelizes naturally.

							* There is a vehicle up in the sky, with a sensor. 

							* Raw Sensor data is converted to a useable form, like tiff files.

							* The tiff files are post processed into products, which puts them in a form that is usable to
						a specific scientific community and at a resolution that is approved by relevant regulatory
						standards.
						
						* For instance a false color image that shows particular
						features of the landscape, like water or vegetation.

						* The final images are tiles that have metadata that is indexed in a search engine. 
						
						* The metadata includes entries like timestamps an image was collected and the satellite,
						location of of the image, and zoom level.
					</aside>
				</section>
				
				<section>
					<img src="images/googlemaps.png" />
					
					<aside class="notes">
							* This is a google maps screenshot of philadelphia.

						* As web developers, we see several layers - 
							- The satellite imagery
							- Vector data for roads
							- Pushpins for landmarks
							- UI controls
					</aside>
				</section>

				<section>
					<h3>Leaflet.js</h3>
					<pre>
						<code data-trim data-noescape>								
							const position = [39.9526, -75.1652 ];

							const Map = () => 
							  &lt;LeafletMap center={position} zoom={11}>
							    &lt;TileLayer
							      attribution='&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
							      url='https://{s}.tile.osm.org/{z}/{x}/{y}.png'
							    />
							    &lt;Marker position={position}>
							      &lt;Popup>
							        A &lt;b>popup&lt;/b>.
							      &lt;/Popup>
							    &lt;/Marker>
							  &lt;/LeafletMap>
						</code>
					</pre>
					
					<aside class="notes">
						* Leaflet.js is a nice library to let us do this.

						* This is the react version.
					</aside>
				</section>

				<section>
					<h3>Historic Aerial Footage</h3>
					<img src="images/historical_footage.gif" >
					
					<aside class="notes">
						* Here is a sample use case. A team at open drone map took some historical
						images collected through aerial photography. This visualization shows those
						images stitched together and overlaid on a modern map.
					</aside>
				</section>
				
				<section>
					<h3>Cloud Native</h3>
					
					<aside class="notes">
						* AWS is appealing for processing data, because we can scale up infinitely.

						* The demand for maps of a particular area varies widely- for instance during a 
						hurricane, a lot of people are interested in a particular area for relief efforts.

						* So, scaling down to 0 on the backend is also appealing.

						* We've had some discussions internally about what makes these applications
						cloud native.
					</aside>
				</section>

				<section>
					<h3>Development paradigms</h3>
					<ul>
						<li>Desktop</li>
						<li>Mobile</li>
						<li>IOT</li>
					</ul>
					
					<aside class="notes">
						* I started out doing desktop development in Delphi.

						* The tricky thing there was driver conflicts, or a user machine running out of disk space.

						* In mobile development, your apps have to scale to screen sizes appropriately.

						* In IOT, you expect an intermittent network connection, and low-power devices.

						* All of these constraints have forced developers to invent great innovations in software
						development.

						* The cloud is different.
					</aside>
				</section>

				<section>
					<img src="images/what-are-clouds-meme.jpg" />
					
					<aside class="notes">
							* At a basic level, using a cloud provider is just renting servers from someone else.
					</aside>
				</section>

				<section>
					<img src="images/aws-user-evolution.png" />
					
					<aside class="notes">
							* But for anyone who has tried using AWS, you quickly realize it is a very complex offering.

							* I found this illustration that visualizes the experience well.

							* You might first use a cloud provider to store files in S3, or to use virtual machines.

							* But then, as your usage becomes more sophisticated, you realize that AWS has over 100 products
						and 10s of thousands of pages of documentation.

						* We need a way to think clearly about which offerings we should use.
					</aside>
				</section>
				
				<section>
					<h3>Bring your own vs. Managed</h3>
					<ul>
						<li>SaaS</li>
						<li>Functions</li>
						<li>Scaling</li>
						<li>Runtime</li>
						<li>OS</li>
						<li>Virtualization</li>
						<li>Hardware</li>
					</ul>
					
					<aside class="notes">
							* This is a list of layers you could imagine in a software stack.

							* If you're a full stack developer, this is larger than the layers you
						would typically interact with.

						* It includes hardware and virtualization at the low levels, and SaaS products
						at the high levels.

						* At each layer, you can bring your own resources, or use those provided by AWS.

						* For instance, you can let them back up databases for you, or you could implement
						this yourself. You can't bring your own hardware per se, but if you work for
						an organization that has a data center, you can fairly easily set up a private
						network link between them, and build a hybrid cloud.

						* As a developer, you can build your own cloud native applications that pick
						and choose architectural components from each layer.

						* In a large enterprise, many of these are typically
						controlled by different teams - for instance DBAs, or a team that manages a 
						data center.
						
						* What makes this cool is that if you have enough permissions in an AWS account, 
						you aren't constrained by those organizational barriers.
					</aside>
				</section>
	
				<section>
					<h1>Stability</h1>
					
					<aside class="notes">
							* So the first objective to achieve robust software is stability. 
						
							* This one is the most readily visible to all of us, and it's typically 
						a primary responsiblity of development teams.
					</aside>
				</section>

				<section>
					<h3>App Architecture</h3>
					<ul>
						<li>S3 hosted front-end</li>
						<li>JavaScript Microservices (API Gateway + Lambda)</li>
						<li>RDS database, with automatic backups</li>
						<li>A private link to a customer account</li>
					</ul>
					
					<aside class="notes">
							* This is an architecture we're seeing frequently for web-based applications.

							* We use a single page app on static hosting on Amazon S3.

						* We have javascript microservices that sit behind it, and read and write
						data from some database, which is fully managed by AWS.

						* If we need to integrate with a client's APIs, we can use private network links.

						* I come from the background of doing full stack development. 
						
						* I like that cloud providers let us outsource a lot of heavy lifting 
						on the backend, so that we don't have to go through the effort to test
						a highly available system. 
						
						* So I as a application developer can do light
						devops work and rely on the provider to bring their judgement to bear 
						on the problems at hand.
					</aside>
				</section>

				<section>
					<h3>Gatsby</h3>
					<ul>
						<li>Wraps webpack</li>
						<li>Builds static sites / single page apps</li>
						<li>JAMStack - REST apis or Graphql</li>
					</ul>
					
					<aside class="notes">
							* Gatsby describes itself as a "blazing fast modern site generator for React"
						
							* That you can use to "go beyond static sites: build blogs, ecommerce sites, full-blown apps".

							* If you've used react-starter-kit you'll have a good feel for what it does - 
						provides pre-built tooling to set up sites with REST backends.

						* I like this because I've not had to touch webpack since we adopted it.
					</aside>
				</section>

				<!--section>
					<h3>Testing</h3>
					<ul>
						<li>BDD</li>
						<li>Checks for issues with underlying dependencies</li>
					</ul>
					
					<aside class="notes">
						
					</aside>
				</section --> 

				<section>
					<h3>Microservices - Stability</h3>
					<ul>
						<li>Multiple copies of the app</li>
						<li>Servers / containers dedicated to modules</li>
						<li>Switch out APIs without code changes</li>
					</ul>
					
					<aside class="notes">
							* The selling point of microservices for me is that if you have an operational 
						issue, you can limit the downtime of a site to one area.

						* We've found that it makes sense to have services built around modules in a system.

						* For instance, if you have a module that exports reports, and goes down, you 
						can still let your users log in and browse what you have to offer.

						* In practice this also means having multiple copies of the application running 
						in parallel - for instance AWS Lambda does this in multiple container like 
						processes on the firecracker VM.

						* APIs can be very complex, so I've been skeptical that you could 
						swap out one provider for another, but in a geospatial application,
						there is a really good reason to do this.
					</aside>
				</section>

				<section>
					<h3>Map Tiles</h3>
					<img src="images/geotiffjs-tile.png" />
					
					<aside class="notes">
							* When you're rendering maps in a web UI, you pull down small sections of a map
						called tiles from the backend.
					</aside>
				</section>

				<section>
					<h3>Geotiff.js - Tile</h3>
					<img src="images/geotiffjs-1tif.png" />
					
					<aside class="notes">
							* In the previous example, the tile was a small section of the map , which was
						downloaded using a byte-range request from Javascript to S3.

						* The full file behind this tile was 1.5 GB.
					</aside>
				</section>

				<section>
						<h3>Web UI Backend - Tiles</h3>
						<ul>
							<li>
								Hosted - Mapbox, OpenStreetMap
							</li>
							<li>
								Folder structure: zoom + location
							</li>
							<li>
								S3 - byte ranging 
							</li>
						</ul>
					
						<aside class="notes">
								* If you're building a mapping app, you can use a vendoer that offers tiles, 
							such as mapbox or OpenStreetMap.

							* If your product matures to the point where you want to offer processed data,
							such as images annotated with machine learning, you can swap out for your
							own tile service.

							* This tile service might just be a file system with images stored in the x, y, and zoom
							locations, or it might be the S3 byte range request style I mentioned previously.

							* But either way, this is cool because the API is really naturally to swap out.
						</aside>
					</section>

				<section>
					<h3>DevOps</h3>
					<!-- TODO - run this to see what the cloudformation it makes is -->

					<pre style="width: 100%"><code data-trim data-noescape style="width: 100%; max-height: 800px">
								export class MyEcsConstructStack extends core.Stack {
								  constructor(scope: core.App, id: string, props?: core.StackProps) {
								    super(scope, id, props);
								    let vpc = new ec2.Vpc(this, "MyVpc", {});
								    let cluster = new ecs.Cluster(this, "MyCluster", {vpc});
									
								    new ecs_patterns.ApplicationLoadBalancedFargateService(this, {
								      cluster: cluster,
								      desiredCount: 6, 
								      taskImageOptions: { 
								        image: ecs.ContainerImage.fromRegistry("amazon/sample") 
								      },
								      memoryLimitMiB: 2048
								    });
								  }
								}
					</code></pre>
					
					<aside class="notes">
							* Our final pillar of stability is DevOps.

							* What's cool here is that AWS has released a  set of libraries called the
						AWS Cloud Development Kit, which is in TypeScript. This example outputs a
						Cloudformation template that stands up an ECS cluster to process data.
						
						* This means you can do frontend, backend, and Devops work all in Javascript.
					</aside>
				</section>

				<section>
					<h1>Security</h1>
					
					<aside class="notes">
							* The second pillar of robustness is security.

							* This is a different mindset, because it's something that is an area
						outside of web development and not often our primary responsibility.

						* However, it's important for security to be considered during the 
						entire software development lifecycle, and if we fail we lose the trust
						of our users or sponsors.
					</aside>
				</section>

				<section>
					<h1>Security - Tactics</h1>
					<ul>
						<li>Limit blast radius</li>
						<li>Least privilege</li>
						<li>Outsource the hard parts</li>
					</ul>
					
					<aside class="notes">
							* Here our tactics are to reduce the risk and scope of problems as much as we can.

							* Microservices in Lambda mean we don't have servers to get hacked - we rely entirely
						on AWS for that.

						* Anyone who has worked on a cloud native app will be forced to learn something about 
						permissions, because your services and accounts by default do not have permission to
						do anything.

						* This causes a lot of frustration for developers.

						* However, there is a bright side. When a dev pulls a ticket from JIRA, they can add
						a permission in code in scripts, which gives you a natural audit trail. This microservice
						has permissions because this feature required it.
					</aside>
				</section>

				<section>
					<h1>Function Context</h1>
					<pre>
						<code data-trim data-noescape>
							(x) => x * x
						</code>
					</pre>
					
					<aside class="notes">
							* Intuitively, lambdas seem really simple - this is one that squares a number.
					</aside>
				</section>	
				
				<section>
					<h1>Function Context</h1>
					<pre>
						<code data-trim data-noescape>
							(x) => &lt;h1>{x}&lt;/h1>
						</code>
					</pre>
					
					<aside class="notes">
							* If we're doing web development though, we expect to see something more like this,
						where we return some JSX code.
					</aside>
				</section>	

				<section>
					<h1>Function Context</h1>
					<pre>
						<code data-trim data-noescape>
							(x, y) => 
							  db.query(
								`update data set x = $1 where y = $2`, 
								[x, y])
						</code>
					</pre>
					
					<aside class="notes">
							* If we were writing backend code, we'd see something more like this, where
						we update data in a database with SQL.
					</aside>
				</section>

				<section>
					<h3>Execution Context</h3>
					<ul>
						<li>Logging (Cloudwatch)</li>
						<li>Container</li>
						<li>Defined memory/CPU/disk</li>
						<li>Security groups</li>
						<li>ENI</li>
					</ul>
					
					<aside class="notes">
							* All of these examples are pretty simple, but when we use AWS lambda we 
						see a fundamental difference between a JavaScript lambda and a function
						that runs in a cloud service.

						* The function in a cloud service runs inside of a box.

						* A simple console.log in a browser, would write to Cloudwatch in AWS, and costs
						us some money.

						* By and large the walls of that box protect us from security issues.

						* Since our code runs in a container, it has limited use of ram, cpu, and disk. 

						* So in a restricted enviroment, someone could not mine very much bitcoin if they got their code into our lambdas.

						* AWS also attaches security groups and a network card to the lambda, which limits what other APIS it can talk to and do.
					</aside>
				</section>

				<section>
					<h3>Affordability</h3>
					
					<aside class="notes">
							* Software is expensive to build, typically with a large amount of money spent up front,
						followed by some maintenance cost over perhaps a decade. 
						
						* Using the cloud changes how we think about the maintenance costs, because we are paying
						a vendor for services mixed with our own operations team, rather than just having the 
						operations team.

						* Before I talk about this third pillar of robustness, I want to provide an example
						of why this is so important.
					</aside>
				</section>

				<section>
					<h3>Forest Fire</h3>
					<img src="images/forest_fire.png" />
					
					<aside class="notes">
							* This is a tool called Headlamp that a team at E84 is building for demo purposes.

							* The idea is that in a disaster response situation, first responders need a dashboard of the situation.

							* A map is natural fit for this, and this shows an example of a forest fire.

							* We overlay the map with some data about the known extent of the fire.
						
							* A hypothetical call center takes calls from people on the ground, and makes pushpins on the map, 
						for instance if someone's pet has gone missing.

						* In this situation, some of the code has to run on site, because the network connection may be poor.
					</aside>
				</section>
			
				<section>
					<h3>Drone Path</h3>
					<img src="images/drone_path.jpeg" />
					
					<aside class="notes">
							* To make matters difficult, organizations that respond to these situations often have 
						drones that collect imagery that needs to be stitched together and overlaid on the map.

						* This image shows the path a drone might take to image a farm field.
					</aside>
				</section>

				<section>
					<h3>Processing Pipeline</h3>
					<ul>
						<li>Science code (Docker, Python, ...)</li>
						<li>JavaScript - Glue code</li>
						<li>Web UIs for monitoring</li>	
					</ul>
					
					<aside class="notes">
							* Regardless of the use case, all imagery runs through a processing pipeline.

							* There are three types of software here.

							* Science code does all the interesting math bits, and it's almost always python code
						that lives in a docker container.

						* Javascript is frequently used as glue code to make each step of the process start
						when the previous one finishes.

						* Because these pipeines take some time, there are often dashboards just to monitor them.
					</aside>
				</section>

				<section>
					<h1>Science Code</h1>
					
					<aside class="notes">
							* Even though the science code is not javacscript, I've have a couple examples
						so that it's clear what it is for.
						
					</aside>
				</section>

				<section>
					<h3>Projection</h3>
					<img src="images/projection2.png" />
					
					<aside class="notes">
							* Projectiion is a simple mathematical transformation from a round earth to the rectangular
						coordinate system we need for a web UI.
					</aside>
				</section>

				<section>
					<h3>Ground Control Point</h3>
					<img src="images/ground_control_point.jpg" />
					
					<aside class="notes">
							* Ground control points are markers on the ground with a known, fixed position.

							* The science code can find these to line up our stitched together image with 
						known locations for measurements or correctly overlaying on top of other imagery.
					</aside>
				</section>
				
				<section>
					<pre>
						<code data-trim data-noescape>
							const sqs = new AWS.SQS({apiVersion: '2012-11-05'});
							const queueURL = "SQS_QUEUE_URL";
							const params = { QueueUrl: queueURL };
							
							sqs.receiveMessage(params, (err, data) => {
								...CALL YOUR LAMBDA HERE...

								const deleteParams = {
								QueueUrl: queueURL,
								ReceiptHandle: data.Messages[0].ReceiptHandle
								};

								sqs.deleteMessage(deleteParams, ...);
							}})
						</code> 
					</pre>	
					
					<aside class="notes">
							* In all our processing pieline,, we need the ability to handle tasks that fail.

							* We might have machines drop off a network, if we do it on laptops in a disaster,
						or we might want to be able to add new machines to a cluster if we're doing it
						in AWS.

						* Either way, the solution to this is to use a queue to maintain the statues of
						all the work in our pipeline.
					</aside>
				</section>

				<section>
					<h3>Cloud - Resources</h3>
					<ul>
						<li>CPU</li>
						<li>Memory</li>
						<li>Disk</li>
						<li>Network</li>
					</ul>
					
					<aside class="notes">
							* Our workload will use some combination of these four fundamental resources.

							* AWS would like use to use more of these, and if we maximize our usage of what we
						rent from them, we'll get a better value.
					</aside>
				</section>

				<section>
					<h3>
						A Software architect can plan using future costs
					</h3>
					<ul>
						<li>Now: Story points (time + risk)</li>
						<li>Future: Operational cost (NPV / cost shape)</li>
					</ul>
					
					<aside class="notes">
							* If you work on an agile team, you most likely go through an estimation process, where
						you note story points for a feature, which are a mixed measure of time, complexity, and risk.

						* In the future, we could estimate the estimated cost of a feature to maintain.

						* For instance, if we add the ability to process drone imagery to our mapping software,
						we need some virtual machines, and that scales with the amount of customers we have.
					</aside>
				</section>

				<!--section>
					<h3>Javascript</h3>
					<ul>
						<li>Rate of change</li>
					</ul>
					
					<aside class="notes">
						
					</aside>
				</section-->

				<section>
					<h3>Collections</h3>
					<img src="images/earthdatasearch.png" />
					
					<aside class="notes">
							* This is an image of a search engine NASA offers to locate public datasets of 
						satellite imagery.

						* What's notable about this is that their data collection programs have existed 
						for decades.

						* In the javascript ecosystem, there is a lot of churn right now - new libraries,
						new features in browsers and cloud vendors.

						* If we're building things that make the world better, we hope they last a long time.

					</aside>
				</section>

				<section>
					<h3>Metrics for reliability</h3>
						<li>How long will our software continue to build?</li>
						<li>How long will our software continue to deploy?</li>
						<li>How long will our software continue to work?</li>
					</ul>
					
					<aside class="notes">
							* I want to leave you with three questions to provoke thought.

							* I don't have answers. My hope is that these might inspire you to think differently
						about how you develop software.

						* If you walked away from a product you've built for six months or a year, will it...

						* If we're building things that make the world better, we hope they last a long time.
					</aside>
				</section>
<!--				(endgame: we need to build ever more robust systems)

				Anecdote - another breach? or chaos monkey?

				Combine that summary with a wrap-up quote, fact or anecdote 
		that reminds your audience of your main topic. A restatement 
		of the moral or lesson works well for a narrative speech with 
		this message.-->


				
				<!--section>
					TODO: more memes
				</section-->

				<!--

				

				

				<section>
					<img src="images/grand_canyon.jpg" />
				</section>
							
				
			-->
				<!--section>
					<h3>Unbundled pricing</h3>
					<ul>
						<li>CPU</li>
						<li>Memory</li>
						<li>Disk</li>
						<li>Network</li>
					</ul>
				</section>

				<section>
					<h3>Power dynamics with the provider</h3>
					<ul>
						<li>Many cloud services are "free" - e.g. ECS</li>
						<li>Reserved instances</li>
						<li>In vs. out of network</li>
					</ul>
				</section-->
					
				<!--section>
					<h3>
						A Software architect can plan using future costs
					</h3>
					<ul>
						<li>Now: Story points (time + risk)</li>
						<li>Future: Operational cost (NPV / cost shape)</li>
					</ul>
				</section-->	
				<!--
				<section>
					<h3>Case study: satellite imagery data pipeline</h3>
				</section>

	
				<section>
					<h3>Historic Aerial Footage</h3>
					<img src="images/historical_footage.gif" >
				</section>
	
				
				
				<section>
					TODO - leafleft
				</section>

				

				<section>
					TODO - cloudformation
				</section>

				<section>
					TODO - example Javascript as orchestration
				</section>

				<section>
					<h1>DigitalGlobe</h1>
					<ul>
						<li>80 TB/day</li>
						<li>100 PB Stored</li>
						<li>40% cache hit rate</li>
					</ul>
				</section>

				<section>
					TODO - security of source images? regulatory?
				</section>

			

				<section>
					<h1>AWS Groundstation</h1>
					<img src="images/groundstation-disaster.png" />
				</section>

				

				<section>
					TODO - make the mixes of languages more apparent
				</section>

				<section>
					TODO - would a CDK example help?
				</section>

				<section>
					TODO - go through the slides as different people
				</section>

			
			-->
				<!--section>
					TODO: add something about network infrastructure
					  E.g. privatelink
				</section-->
				<!--
				
				<section>
					<h3>Lenses</h3>
					<img src="images/lenses.png" />
				</section>
				
				<section>
					<h3>Product Creation</h3>
				</section>

				<section>
					<h3>Vegetation</h3>
					<img src="images/vegetation.png" />
				</section>

				<section>
					<h3>NVDI</h3>
					<pre>
						<code data-trim data-noescape>
							NVDI = (NIR - Red) / (NIR + Red)
						</code>
					</pre>
				</section>

				<section>
					<h3>Geospatial Data Abstraction Library (GDAL)</h3>
						<pre>
							<code data-trim data-noescape>
							red_band = dataset.GetRasterBand(3)
							nir_band = dataset.GetRasterBand(4)
							
							red_scanline = red_band.ReadRaster( 0, line, \
							   red_band.XSize, 1, red_band.XSize, 1, gdal.GDT_Float32 )
							red_tuple = struct.unpack('f' * red_band.XSize, red_scanline)
				
							nir_scanline = nir_band.ReadRaster( 0, line, \
							   nir_band.XSize, 1, nir_band.XSize, 1, gdal.GDT_Float32 )
							nir_tuple = struct.unpack('f' * nir_band.XSize, nir_scanline)

							for i in range(len(red_tuple)):
  							    ndvi_lower = (nir_tuple[i] + red_tuple[i])
							    ndvi_upper = (nir_tuple[i] - red_tuple[i])
				
						</code>
					</pre>
				</section>

				<section>
					<h3>AWS Lambda Layers</h3>
					<pre>
						<code data-trim data-noescape>
							TODO - rewrite this example
							docker volume create test-volume

							...install gdal...

							docker run -d \
							  --mount source=test-volume,target=/opt,readonly \
							  nginx:latest
						</code>
					</pre>
				</section>

				<section>
					<pre>
						<code data-trim data-noescape>
							TODO - these examples don't work here - need to fix the story up
								docker run
								    --memory=2g
								    --cpus=1.5
								    node index.js
						</code>
					</pre>
				</section>

				<section>
					<pre>
						<code data-trim data-noescape>
							docker run
								--memory=2g
								--cpus=1.5
								-v volume-name:/opt:ro
								node index.js
						</code>
					</pre>
				</section>
	
				<section>
					<pre>
						<code data-trim data-noescape>
							timelimit -T 600
								docker run
									--memory=2g
									--cpus=1.5
									-v volume-name:/opt:ro
									node index.js
						</code>
					</pre>
				</section>

				<section>
					TODO - simulating the cloud locally?
				</section>

				<section>
					<h3>On a cloud native app...</h3>
					<ul>
						<li>Platform > Language</li>
						<li>You are forced to pay attention to security...</li>
						<li>...everyone learns something about DevOps</li>
						<li>...while outsourcing judgement to AWS</li>
					</ul>
				</section>
			-->

				<!--section>
					<h3>Empowering Scientific Use</h3>
				</section>

	
				<section>
					<h3>Web UI Backend - Tiles</h3>
					<ul>
						<li>
							Hosted - Mapbox, OpenStreetMap
						</li>
						<li>
							Folder structure: zoom + location
						</li>
						<li>
							S3 - byte ranging 
						</li>
						<li>
							Search API - Elasticsearch
						</li>
					</ul>
				</section>

				<section>
					<h3>Collections</h3>
					<img src="images/earthdatasearch.png" />
				</section>

				<section>
					<img src="images/landsat-s3.png" />
				</section>

				<section>
					<h3>Map Tiles</h3>
					<img src="images/geotiffjs-tile.png" />
				</section>

				<section>
					<h3>Geotiff.js - Tile</h3>
					<img src="images/geotiffjs-1tif.png" />
				</section>

				<section>
					<img src="images/grand_canyon.jpg" />
				</section>

				<section>
					<h3>Operator - the streams</h3>
					<ul>
						<li>Code/data</li>
						<li>CI, deployments, monitoring, backup, ...</li>
					</ul>
				</section>
				
				<section>
					<h3>Design - the walls</h3>
					<ul>
						<li>Build boxes around the code - network, disk, RAM, ACLs, etc</li>
						<li>...or tunnels</li>
					</ul>
				</section -->

				<!--section>
					<pre>
						<code data-trim data-noescape>
							f(configuration) => resources
						</code>
					</pre>
				</section>

				<section>
					<div style="font-size: 80%">
						<pre>
							<code data-trim data-noescape>
								WebsiteBucketPolicy:
									Type: AWS::S3::BucketPolicy
									Properties: 
									Bucket: <mark>!Ref WebsiteBucket</mark>
									PolicyDocument: 
									Statement: 
										- 
										Action: 
											- "s3:GetObject"
											Effect: "Allow"
										Resource: 
											Fn::Join: 
											- ""
												- 
												- "arn:aws:s3:::"
												- Ref: "WebsiteBucket"
												- "/*"
										Principal: "*"
							</code>
						</pre>
					</div>
				</section-->
	

				<!--section>
					<h3>From Software Engineer to DevOps</h3>
					<ul>
						<li>Learn Cloudformation and script everything</li>
						<li>Take advantage of managed services (Aurora, Elasticsearch)</li>
						<li>Gives you HA, Backups, Patching, Virus scanning</li>
						<li>Take advantage of Cloudformation template apps - E.g. WAF Security Automations</li>
					</ul>
				</section>
				
				<section>
					<h3>Pain Points - Development</h3>
					<ul>
						<li>APM tools</li>
						<li>Debugging remote execution</li>
						<li>Learning IAM</li>
						<li>Learning how datacenters work (networks, firewalls)</li>
					</ul>
				</section-->
	

				<!--section>
					<h1>UI + Backend Architecture</h1>
					<ul>
						<li>Gatsby - Web UIs hosted on S3 + Cloudfront</li>
						<li>Leaflet.js</li>
						<li>Microservices</li>
					</ul>
				</section-->


				<!--section>
					<h3>Virtualized Datacenter</h3>
					<ul>
						<li>Network interfaces (ENI)</li>
						<li>Routers (VPCs)</li>
						<li>Switches (VPC peering, PrivateLink)</li>
						<li>Firewalls (WAF)</li>						
					</ul>
				</section-->

				<!--section>
					<img src="images/aws-user-evolution.png" />
				</section-->

				<!--section>
					<h3>Functional programming</h3>
					<blockquote cite="https://en.wikipedia.org/wiki/Functional_programming">
						A paradigm that treats computation as the evaluation of 
						mathematical functions and avoids changing state and mutable data. 
						
						The output of a function depends only on the arguments passed
						to a function, so calling a function twice with the same arguments produces
						the same result each time...
					</blockquote>
				</section-->
			
				<!--section>
					<h1>Side-effects</h1>
					<ul>
						<li>Account limits</li>
						<li>Billing</li>
						<li>Time spent</li>
					</ul>
				</section-->
				
				<!--section>
					<img src="images/lambda.png" />
				</section-->

				<!--section>
					<h3>index.js</h3>
					<pre>
						<code data-trim data-noescape>
								(event, context, callback) => 
									callback("Success")
						</code>
					</pre>
				</section>
	
				<section>
					<pre>
						<code data-trim data-noescape>
							(event, context, callback) => 
								callback(&lt;h3>Hi!&lt;/h3>)
						</code>
					</pre>
				</section>
				
				<section>
					<pre>
						<code data-trim data-noescape>
							(event, context, callback) => {
								console.log("I was here.");

								callback(&lt;h3>Hi!&lt;h3>);
							}
						</code>
					</pre>
				</section-->

				<!--section>
					<h3>Idempotency</h3>
					<ul>
						<li>AWS SAM</li>
						<li>localstack</li>
					</ul> 
				</section-->

				<!--section>
					<pre>
						<code data-trim data-noescape>
							(s3Event) => {
								...OCR a document...
							}
						</code>
					</pre>
				</section-->
					
				<!--section>
					<h3>
						Lessons Learned
					</h3>
					<ul>
						<li>Some DevOps outsourced to AWS is the work that requires judgement</li>
						<li>AWS forces you to learn DevOps</li>
						<li>Forced awareness of security</li>
						<li>We're all DevOps</li>
					</ul>
				</section -->

				<!--section>
					<h3>From Software Engineer to DevOps</h3>
					<ul>
						<li>Learn Cloudformation and script everything</li>
						<li>Take advantage of managed services (Aurora, Elasticsearch)</li>
						<li>Gives you HA, Backups, Patching, Virus scanning</li>
						<li>Take advantage of Cloudformation template apps - E.g. WAF Security Automations</li>
					</ul>
				</section-->
				
				<!--section>
					<h3>Pain Points - Development</h3>
					<ul>
						<li>APM tools</li>
						<li>Debugging remote execution</li>
						<li>Learning IAM</li>
						<li>Learning how datacenters work (networks, firewalls)</li>
					</ul>
				</section  -->



				<!--section>
					<h3>Pain Points - Operations</h3>
					<ul>
						<li>Accidental coupling</li>
						<li>Draining connections during a deploy</li>
						<li>Blue/green deployment?</li>
					</ul>
				</section>

				<section>
					<h3>Example Project: OpenDroneMap</h3>
					<ul>
						<li>Obtain your own images</li>
						<li>Stitch together with a processing pipeline</li>
						<li>Viewer</li>
					</ul>
				</section -->
				
				<!--section>
					<h3>Example project: Cumulus</h3>
					<ul>
						<li>
							Run jobs to copy large sets of files
						</li>
						<li>Wrap AWS services</li>
						<li>Dashboard UI to monitor progress</li>
					</ul>
				</section -->

				<!--section>
					<h3>Example project: Marblecutter</h3>
					<ul>
						<li>Processing pipeline - big images to tiles</li>
					</ul>
				</section-->


				<!--section>
					<h3>Security</h3>
					<ul>
						<li>Increase focus on code issues</li>
						<li>Tight network controls</li>
					</ul>
				</section>

				<section>
					<h3>ECS</h3>
					<ul>
						<li>TODO</li>
					</ul>
				</section -->

				<!--section>
					<h3>Spot instances</h3>
					<ul>
						<li>Does this make it cheaper to do stuff?</li>
						<li>Can you get GPUs cheaper this way?</li>
					</ul>
				</section -->

				<!--section>
					<h3>Containerization</h3>
					<ul>
						<li>This helped me learn a ton about DevOps</li>
						<li>One possible way to develop locally stuff that is sent to the cloud</li>
						<li>Lambda layers - a way to distribute hard to compile stuff like GDAL</li>
						<li>A way to get GPU code hidden</li>
						<li>A way to bring forward old science code (fortran)</li>
					</ul>
				</section-->

				<!--section>
					<h3>Lessons Learned</h3>
					<ul>
						<li>Use the right tool (product) for the job</li>
						<li>Choosing vendors > language</li>
					</ul>
				</section-->

			<!--	<section>
					<h3>Backend - Javascript lambdas</h3>
					<ul>
						<li>Cost control</li>
						<li>Fast startup time</li>
						<li>Microservices</li>
					</ul>
				</section>	

				<section>
					TODO - expand thoughts on lambda
				</section>

				<section>
					<h3>Microservices - Stability</h3>
					<ul>
						<li>Multiple copies of the app</li>
						<li>Servers / containers dedicated to modules</li>
						<li>ALB + Path based routing</li>
						<li><i>No code changes required</i></li>
					</ul>
				</section>

				<section>
					<h3>Approvals</h3>
					<ul>
						<li>External certification - Fedramp (approval = AWS's problem)</li>
						<li>Unified Billing (e.g. buy through marketplace)</li>
					</ul>
				</section>

				<section>
					<h3>Build your own map UI</h3>
				</section>		-->		

				<!--section>
					<h3>Libraries</h3>
					<pre>
						<code data-trim data-noescape>		
								yarn add gatsby-plugin-react-leaflet \
										 react-leaflet \
										 leaflet
						</code>
					</pre>
				</section-->

				<!--section>
					<h3>gatsby-config.js</h3>
					<pre>
						<code data-trim data-noescape>		
							plugins: [
							  {
							    resolve: 'gatsby-plugin-react-leaflet',
							    options: {
							      linkStyles: true 
							    }
							  }
							]
						</code>
					</pre>
				</section-->

<!--				<section>
					<h3>Leaflet.js</h3>
					<pre>
						<code data-trim data-noescape>								
							const position = [39.9526, -75.1652 ];

							const Map = () => 
							  &lt;LeafletMap center={position} zoom={11}>
							    &lt;TileLayer
							      attribution='&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
							      url='https://{s}.tile.osm.org/{z}/{x}/{y}.png'
							    />
							    &lt;Marker position={position}>
							      &lt;Popup>
							        A &lt;b>popup&lt;/b>.
							      &lt;/Popup>
							    &lt;/Marker>
							  &lt;/LeafletMap>
						</code>
					</pre>
				</section>

				<section>
					<img src="images/leaflet-philly.png" />
				</section>

				<section>
					<h3>S3</h3>
					<ul>
						<li>TODO: S3 hosting - notes or image</li>
					</ul>
				</section>

				<section>
					TODO: consider adding something about Sagemaker (etc)
					  Example of a more managed product that's easy to adopt
				</section>

			-->
				<!--section>
					<h1>Geo-referencing</h1>
					<ul>
						<li>JavaScript is glue here</li>
						<li>TODO - is that the right term?</li>
						<li>Choose coordinate system (WGS...)</li>
						<li>Something on the ground?</li>
						<li>Location of satellite (by timestamp)</li>
						<li>Mathy code- in docker</li>
						<li>ECS?</li>
					</ul>
				</section -->

				<!-- section>
					<h1>Regulatory</h1>
					<ul>
						<li>Resolution - in general</li>
						<li>Resolution over hotspots (Israel, protected sites)</li>
						<li>Who can download the data?</li>
						<li>Varies by country where provider is located</li>
						<li>GDPR</li>
					</ul>
				</section -->

			
				<!--section>
					<h3>
						Cloud-Native Attributes
					</h3>
					<ul>
						<li>
							Manage your own datacenter
						</li>
						<li>
							Full stack - from virtualized hardware to SaaS
						</li>
						<li>
							Mixed environments (on/off prem)
						</li>
						<li>
							Outsource any level
						</li>
						<li>
							Model organizations vs apps
						</li>
					</ul>
				</section-->
			

				<!--section>
					<h3>
						Software architect can use multiple providers
					</h3>
					<ul>
						<li>Google's OAuth</li>
						<li>Heroku's hosting</li>
						<li>AWS Spot instances</li>
					</ul>
				</section-->
				
				<!--section>
					<h3>
						Open-source projects
					</h3>
					<ul>
						<li>Spot pricing is appealing</li>
						<li>Who pays the AWS bill?</li>
						<li>Deploying into unknown environment (VPC)</li>
					</ul>
				</section -->

				<!--section>
					<h3>
						Remote Sensing
					</h3>
					<ul>
						<li>Sensor (in Satellite, Drone, Kite, etc)</li>
						<li>Ground station</li>
						<li>Archival System</li>
						<li>Product creation</li>
						<li>Tile creation</li>
						<li>Web-based mapping</li>
					</ul>
				</section -->

				<!--section>
					<h3>
						Examples
					</h3>
					<ul>
						<li>Open Drone Map</li>
						<li>Cumulus</li>
						<li>Pangeo</li>
						<li>Marblecutter</li>
						<li>Leaflet</li>
						<li>Gdal</li>
					</ul>
				</section -->

			
				<!--section>
					<h3>The sky</h3>
					<ul>
						<li>Log Sensor data</li>
						<li>Ground station</li> 
						<li>Receive commands</li>
					</ul>
				</section-->

				<!--section>
					<h3>The data center</h3>
					<ul>
						<li>Archival (l0)</li>
						<li>Storage</li>
					</ul>
				</section -->

				<!--section>
					<h3>Data pipelines</h3>
					<ul>
						<li>Processing pipeline (l1...ln)</li>
						<li>Science!</li>
					</ul>
				</section-->

				<!--section>
					<h3>End-user applications</h3>
					<ul>
						<li>Desktop apps</li>
						<li>Tiles</li>
						<li>Leaflet.js</li>
					</ul>
				</section-->

				<!--section>
					<h3>Requirements</h3>
					<ul>
						<li>Conversion to end-user formats</li>
						<li>Long-term durability of data</li>
						<li>Tracking data provenance</li>
					</ul>
				</section -->

				<!-- section>
					<h3>Logging</h3>
					<ul>
						<li>Dependencies</li>
						<li>Network hops</li>
						<li>Full stack traces</li>
					</ul>
				</section -->

		

				<!--section>
					<h3>Wordpress</h3>
					<ul>
						<li>What can I do cheaply?</li>
						<li>RDS? HA db?</li>
						<li>WAF?</li>
						<li>Cloudwatch?</li>
						<li>HA front-end</li>
					</ul>
				</section -->


				<section>
					<h3>References</h3>
					<ul>
						<li>https://start.jcolemorrison.com/aws-vpc-core-concepts-analogy-guide/</li>
						<li>https://www.jpl.nasa.gov/spaceimages/details.php?id=PIA14897</li>
						<li>http://learningzone.rspsoc.org.uk/index.php/Learning-Materials/Python-Scripting/9.4-Calculate-NDVI-using-GDAL</li>
					</ul>
				</section>
			</div>
		</div>

		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true }
				]
			});
		</script>


<style type="text/css">
    /* 1. Style header/footer <div> so they are positioned as desired. */
    #header-left {
        position: absolute;
        top: 0%;
        left: 0%;
    }
    #header-right {
        position: absolute;
        top: 0%;
        right: 0%;
    }
    #footer-left {
        position: absolute;
        bottom: 2%;
        left: 2%;
    }
    #footer-right {
        position: absolute;
        bottom: 3%;
        right: 3%;
    }
</style>

<!-- 2. Create hidden header/footer <div> -->
<div id="hidden" style="display:none;">
    <div id="header">
        <div id="header-left"></div>
                <div id="header-right"></div>
                <div id="footer-left"></div>
        <div id="footer-right">@garysieling</div>
    </div>
</div>



<!-- 2. Create hidden header/footer <div> -->
	<div id="hidden" style="display:none;">
		<div id="header">
			<div id="header-left"></div>
					<div id="header-right"></div>
					<div id="footer-left"></div>
			<div id="footer-right">@garysieling</div>
		</div>
	</div>
	
	<script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
	<script type="text/javascript">
		// 3. On Reveal.js ready event, copy header/footer <div> into each `.slide-background` <div>
		var header = $('#header').html();
		if ( window.location.search.match( /print-pdf/gi ) ) {
			Reveal.addEventListener( 'ready', function( event ) {
				$('.slide-background').append(header);
			});
		}
		else {
			$('div.reveal').append(header);
	   }
	</script>
	</body>
</html>
